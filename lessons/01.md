# Lesson 1
## Data modeling and reading data

## Lesson objectives
| Lesson objectives                            | Course objectives                        |
|:---------------------------------------------|:-----------------------------------------|
| Read data from a relationally structed dataset | Design and implement a data model for a small Rails app |

## Spreadsheet to database
When our fictional code school, Dream of Code, was started, the organizers wanted to be lean in their processes, and therefore decided to use a multi-tabbed spreadsheet to track student enrollments, mentor assignments, student submissions, grades and more. Dream of Code organizers knew they'd want to eventually transfer this data to a database, so they set up the spreadsheet to mirror how they expected the data to be represented in a database.

Take a look at [this spreadsheet](). You may want to download it and view it in your own Google Sheets, Libre Office or Excel. It's not necessary for the assignment, but you might find it easier to answer some of the questions if you're able to add data to the spreadsheet yourself.

## Reading relational data
Let's focus first on the tabs titled `coding_classes`, `courses` and `trimesters`.

First some definitions:
- A `trimester` is a term in which classes are held. Spring 2025, for example. In addition to a year and term, every trimester has start and end dates, an application deadline, and a unique identifier (id).
- A `coding_class` is a type of class offered, for example, "Intro to Programming", "React", "Ruby on Rails", etc. In addition to a title, a coding class also has a description and a unique identifier (id).
- A `course` is a specific run of a coding class in a trimester. For example, "Ruby on Rails - Spring 2025". This is why in the `course` tab, we see columns titled `coding_class_id` and `trimester_id`. In addition, a course has a maximum enrollment -- the 
max number of students permitted to enroll.

Watch this short video about the data model. 
TODO video that walks through data model ERD, relates to spreadsheet and DoC tasks.

### Task 1: Email students about upcoming courses
Suppose we need to send an email to all current students in the Intro course, encouraging them to enroll in a course for the upcoming trimester. Let's get the data we need: 

To get the list of classes for the upcoming trimester:
1. Let's say the upcoming trimester is Fall 2025. What is the trimester id that corresponds to that trimester? (Get this from the `trimesters` tab.)
2. Looking at the `courses` tab, find the rows where `trimester_id` matches the id from question 1. For each of these rows, use the `coding_class_id` to reference the corresponding coding class on the `coding_classes` tab. 
3. For each row from question 2, fill in this template, replacing everything in angle brackets (<>) with the data you found above.

```
<course id>, <coding class name> - <trimester term> <trimester year>
```



## Reading data with ActiveRecord
Maybe you can imagine how managing all of the code school's data with a spreadsheet might become unweildy and error prone. Let's start building a web application to manage Dream of Code's data. Some of our coworkers have already gotten started, so let's clone the repository and get familiar with the app.

### TODO Instructions to clone the app and get up and running
- include db:setup to setup seed data
- TODO short video explaining terminal, app, rails commands, rails console, generators, database, database gui


### ActiveRecord
A core library in the Rails framework called ActiveRecord is responsible for the configuration code that allows us to interact with data in the database using Ruby classes. (We'll talk more about Ruby classes in future lessons, but they are similar to Javascript classes or objects.) Let's see how ActiveRecord works.

Each of our tabs from the spreadsheet is now a table in our database, and each is mapped to a Ruby class. Class names in Ruby are singular and Pascal case (a special type of [camel case](https://developer.mozilla.org/en-US/docs/Glossary/Camel_case)), while table names are plural and [snake case](https://developer.mozilla.org/en-US/docs/Glossary/Snake_case). ActiveRecord and Rails depend on this naming convention
to work properly. We'll learn more about this later.

Look in the `app/models/` directory. Each file here is an ActiveRecord model -- a Ruby class that is associated with a table in the database.

In a terminal, start the rails console.

```
bundle exec rails c
```

In the prompt, type `Trimester.last` and hit enter. 

```
  Trimester Load (1.6ms)  SELECT "trimesters".* FROM "trimesters" ORDER BY "trimesters"."id" DESC LIMIT 1 /*application='DocRails'*/
=>
#<Trimester:0x0000000121db9bc0
 id: 9,
 year: "2025",
 term: "Fall",
 application_deadline: "2025-08-15",
 start_date: "2025-09-01",
 end_date: nil,
 created_at: "2025-01-01 19:21:16.044837000 +0000",
 updated_at: "2025-01-01 19:21:16.044837000 +0000">
```

If we look back at our spreadsheet, we'll see that this displays the data from the last row in our spreadsheet. Now type `Trimester.first` in the command prompt and hit enter. We'll see that the data displayed here matches the first row in our spreadsheet. Now try `Trimester.all`. This should print all rows from the spreadsheet.

- `Trimester` is the model or Ruby class that is configured by Rails to map to the database table
`trimesters`. (Analogously, we have models `CodingClass`, `Course`, `Student`, `Enrollment`, which map to tables named `coding_classes`, `courses`, `students`, `enrollments`, etc.)
- The methods `first`, `last` and `all` are ActiveRecord methods called "finder methods". You can find these methods listed in this (section of the Rails Guides)[https://guides.rubyonrails.org/active_record_basics.html#read] Let's try some other methods mentioned in that section.

